import{f as Fe,g as R,i as ht,k as pt,m as X}from"./chunk-JWTZDVRE.js";import{g as c,h as u,i as l,j as ft,k as b}from"./chunk-F76XKWKJ.js";function $e(e,t,r){let i={};for(let n in e.orbits){let a=e.orbits[n],o=t[n],s=r[n];if(Ae(a.numOrientations,s))i[n]=o;else if(Ae(a.numOrientations,o))i[n]=s;else{let m=new Array(a.numPieces);if(a.numOrientations===1){for(let f=0;f<a.numPieces;f++)m[f]=o.permutation[s.permutation[f]];i[n]={permutation:m,orientation:o.orientation}}else{let f=new Array(a.numPieces);for(let d=0;d<a.numPieces;d++)f[d]=(o.orientation[s.permutation[d]]+s.orientation[d])%a.numOrientations,m[d]=o.permutation[s.permutation[d]];i[n]={permutation:m,orientation:f}}}}return i}function xt(e,t,r){let i={};for(let n in e.orbits){let a=e.orbits[n],o=t[n],s=r[n];if(Ae(a.numOrientations,s))i[n]=o;else{let m=new Array(a.numPieces);if(a.numOrientations===1){for(let f=0;f<a.numPieces;f++)m[f]=o.pieces[s.permutation[f]];i[n]={pieces:m,orientation:o.orientation}}else{let f=new Array(a.numPieces);for(let d=0;d<a.numPieces;d++)f[d]=(o.orientation[s.permutation[d]]+s.orientation[d])%a.numOrientations,m[d]=o.pieces[s.permutation[d]];i[n]={pieces:m,orientation:f}}}}return i}var wt=!1,vt=new Map;function dn(e){let t=vt.get(e);if(t)return t;let r=new Array(e),i=new Array(e);for(let a=0;a<e;a++)r[a]=a,i[a]=0;let n={permutation:r,orientation:i};return wt&&(Object.freeze(r),Object.freeze(i),Object.freeze(n)),vt.set(e,n),n}function fn(e){let t={};for(let[r,i]of Object.entries(e.orbits))t[r]=dn(i.numPieces);return wt&&Object.freeze(t),t}function hn(e,t){let r=t.quantum.toString(),i=e.definition.moves[r];if(!i){let o=e.definition.experimentalDerivedMoves?.[r];o&&(i=e.algToTransformation(o).transformationData)}if(i)return $(e,i,t.amount);let n=e.definition.moves[t.toString()];if(n)return n;let a=e.definition.moves[t.invert().toString()];if(a)return $(e,a,-1);throw new Error(`Invalid move for KPuzzle (${e.name()}): ${t}`)}var G=class{constructor(e,t){this.kpuzzle=e,this.stateData=t}toJSON(){return{experimentalPuzzleName:this.kpuzzle.name(),stateData:this.stateData}}static fromTransformation(e){let t=xt(e.kpuzzle.definition,e.kpuzzle.definition.startStateData,e.transformationData);return new G(e.kpuzzle,t)}apply(e){return this.applyTransformation(this.kpuzzle.toTransformation(e))}applyTransformation(e){if(e.isIdentityTransformation())return new G(this.kpuzzle,this.stateData);let t=xt(this.kpuzzle.definition,this.stateData,e.transformationData);return new G(this.kpuzzle,t)}applyMove(e){return this.applyTransformation(this.kpuzzle.moveToTransformation(e))}applyAlg(e){return this.applyTransformation(this.kpuzzle.algToTransformation(e))}experimentalToTransformation(){if(!this.kpuzzle.canConvertStateToUniqueTransformation())return null;let e={};for(let[t,r]of Object.entries(this.stateData)){let i={permutation:r.pieces,orientation:r.orientation};e[t]=i}return new D(this.kpuzzle,e)}experimentalIsSolved(e){if(!this.kpuzzle.definition.experimentalIsStateSolved)throw new Error("`KState.experimentalIsSolved()` is not supported for this puzzle at the moment.");return this.kpuzzle.definition.experimentalIsStateSolved(this,e)}},I,gt,D=(gt=class{constructor(e,t){u(this,I,void 0);this.kpuzzle=e,this.transformationData=t}toJSON(){return{experimentalPuzzleName:this.kpuzzle.name(),transformationData:this.transformationData}}invert(){return new D(this.kpuzzle,yt(this.kpuzzle,this.transformationData))}isIdentityTransformation(){return c(this,I)??l(this,I,this.isIdentical(this.kpuzzle.identityTransformation()))}static experimentalConstructIdentity(e){let t=new D(e,fn(e.definition));return l(t,I,!0),t}isIdentical(e){return xn(this.kpuzzle,this.transformationData,e.transformationData)}apply(e){return this.applyTransformation(this.kpuzzle.toTransformation(e))}applyTransformation(e){if(this.kpuzzle!==e.kpuzzle)throw new Error(`Tried to apply a transformation for a KPuzzle (${e.kpuzzle.name()}) to a different KPuzzle (${this.kpuzzle.name()}).`);return c(this,I)?new D(this.kpuzzle,e.transformationData):c(e,I)?new D(this.kpuzzle,this.transformationData):new D(this.kpuzzle,$e(this.kpuzzle.definition,this.transformationData,e.transformationData))}applyMove(e){return this.applyTransformation(this.kpuzzle.moveToTransformation(e))}applyAlg(e){return this.applyTransformation(this.kpuzzle.algToTransformation(e))}toKState(){return G.fromTransformation(this)}repetitionOrder(){return Sn(this.kpuzzle.definition,this)}selfMultiply(e){return new D(this.kpuzzle,$(this.kpuzzle,this.transformationData,e))}},I=new WeakMap,gt);function Ae(e,t){let{permutation:r}=t,i=r.length;for(let n=0;n<i;n++)if(r[n]!==n)return!1;if(e>1){let{orientation:n}=t;for(let a=0;a<i;a++)if(n[a]!==0)return!1}return!0}function pn(e,t,r,i={}){for(let n=0;n<e.numPieces;n++)if(!i?.ignoreOrientation&&t.orientation[n]!==r.orientation[n]||!i?.ignorePermutation&&t.permutation[n]!==r.permutation[n])return!1;return!0}function xn(e,t,r){for(let[i,n]of Object.entries(e.definition.orbits))if(!pn(n,t[i],r[i]))return!1;return!0}function yt(e,t){let r={};for(let i in e.definition.orbits){let n=e.definition.orbits[i],a=t[i];if(Ae(n.numOrientations,a))r[i]=a;else if(n.numOrientations===1){let o=new Array(n.numPieces);for(let s=0;s<n.numPieces;s++)o[a.permutation[s]]=s;r[i]={permutation:o,orientation:a.orientation}}else{let o=new Array(n.numPieces),s=new Array(n.numPieces);for(let m=0;m<n.numPieces;m++){let f=a.permutation[m];o[f]=m,s[f]=(n.numOrientations-a.orientation[m]+n.numOrientations)%n.numOrientations}r[i]={permutation:o,orientation:s}}}return r}function $(e,t,r){if(r===1)return t;if(r<0)return $(e,yt(e,t),-r);if(r===0){let{transformationData:a}=e.identityTransformation();return a}let i=t;r!==2&&(i=$(e,t,Math.floor(r/2)));let n=$e(e.definition,i,i);return r%2===0?n:$e(e.definition,t,n)}var vn=class extends ht{traverseAlg(e,t){let r=null;for(let i of e.childAlgNodes())r?r=r.applyTransformation(this.traverseAlgNode(i,t)):r=this.traverseAlgNode(i,t);return r??t.identityTransformation()}traverseGrouping(e,t){let r=this.traverseAlg(e.alg,t);return new D(t,$(t,r.transformationData,e.amount))}traverseMove(e,t){return t.moveToTransformation(e)}traverseCommutator(e,t){let r=this.traverseAlg(e.A,t),i=this.traverseAlg(e.B,t);return r.applyTransformation(i).applyTransformation(r.invert()).applyTransformation(i.invert())}traverseConjugate(e,t){let r=this.traverseAlg(e.A,t),i=this.traverseAlg(e.B,t);return r.applyTransformation(i).applyTransformation(r.invert())}traversePause(e,t){return t.identityTransformation()}traverseNewline(e,t){return t.identityTransformation()}traverseLineComment(e,t){return t.identityTransformation()}},gn=pt(vn);function Je(e,t){return t?Je(t,e%t):e}function Sn(e,t){let r=1;for(let i in e.orbits){let n=e.orbits[i],a=t.transformationData[i],o=new Array(n.numPieces);for(let s=0;s<n.numPieces;s++)if(!o[s]){let m=s,f=0,d=0;for(;o[m]=!0,f=f+a.orientation[m],d=d+1,m=a.permutation[m],m!==s;);f!==0&&(d=d*n.numOrientations/Je(n.numOrientations,Math.abs(f))),r=r*d/Je(r,d)}}return r}var A,xe,St,E=(St=class{constructor(e,t){u(this,A,void 0);u(this,xe,void 0);this.definition=e,l(this,A,new Map),this.experimentalPGNotation=t?.experimentalPGNotation}name(){return this.definition.name}identityTransformation(){return D.experimentalConstructIdentity(this)}moveToTransformation(e){typeof e=="string"&&(e=new R(e));let t=e.toString(),r=c(this,A).get(t);if(r)return new D(this,r);if(this.experimentalPGNotation){let n=this.experimentalPGNotation.lookupMove(e);if(!n)throw new Error(`could not map to internal move: ${e}`);return c(this,A).set(t,n),new D(this,n)}let i=hn(this,e);return c(this,A).set(t,i),new D(this,i)}algToTransformation(e){return typeof e=="string"&&(e=new X(e)),gn(e,this)}toTransformation(e){return typeof e=="string"?this.algToTransformation(e):e?.is?.(X)?this.algToTransformation(e):e?.is?.(R)?this.moveToTransformation(e):e}startState(){return new G(this,this.definition.startStateData)}canConvertStateToUniqueTransformation(){return c(this,xe)??l(this,xe,(()=>{for(let[e,t]of Object.entries(this.definition.orbits)){let r=new Array(t.numPieces).fill(!1);for(let i of this.definition.startStateData[e].pieces)r[i]=!0;for(let i of r)if(!i)return!1}return!0})())}},A=new WeakMap,xe=new WeakMap,St);function Ti(e,t,r,i,n){let o=e.orbits[t].pieces[r];if(o===null)return k;let s=o.facelets?.[i];return s===null?k:typeof s=="string"?s:n?s.hintMask??s.mask:(console.log(s),s.mask)}var U=class{constructor(e,t){this.stickerings=new Map;for(let[r,i]of Object.entries(e.definition.orbits))this.stickerings.set(r,new Array(i.numPieces).fill(t))}},k="regular",w="ignored",J="oriented",ve="invisible",B="dim",wn={Regular:{facelets:[k,k,k,k,k]},Ignored:{facelets:[w,w,w,w,w]},OrientationStickers:{facelets:[J,J,J,J,J]},IgnoreNonPrimary:{facelets:[k,w,w,w,w]},Invisible:{facelets:[ve,ve,ve,ve,ve]},PermuteNonPrimary:{facelets:[B,k,k,k,k]},Dim:{facelets:[B,B,B,B,B]},Ignoriented:{facelets:[B,w,w,w,w]},OrientationWithoutPermutation:{facelets:[J,w,w,w,w]}};function yn(e){return wn[e]}var Qe=class extends U{constructor(e){super(e,"Regular")}set(e,t){for(let[r,i]of this.stickerings.entries())for(let n=0;n<i.length;n++)e.stickerings.get(r)[n]&&(i[n]=t);return this}toStickeringMask(){let e={orbits:{}};for(let[t,r]of this.stickerings.entries()){let i=[],n={pieces:i};e.orbits[t]=n;for(let a of r)i.push(yn(a))}return e}},et=class{constructor(e){this.kpuzzle=e}and(e){let t=new U(this.kpuzzle,!1);for(let[r,i]of Object.entries(this.kpuzzle.definition.orbits)){e:for(let n=0;n<i.numPieces;n++){t.stickerings.get(r)[n]=!0;for(let a of e)if(!a.stickerings.get(r)[n]){t.stickerings.get(r)[n]=!1;continue e}}}return t}or(e){let t=new U(this.kpuzzle,!1);for(let[r,i]of Object.entries(this.kpuzzle.definition.orbits)){e:for(let n=0;n<i.numPieces;n++){t.stickerings.get(r)[n]=!1;for(let a of e)if(a.stickerings.get(r)[n]){t.stickerings.get(r)[n]=!0;continue e}}}return t}not(e){let t=new U(this.kpuzzle,!1);for(let[r,i]of Object.entries(this.kpuzzle.definition.orbits))for(let n=0;n<i.numPieces;n++)t.stickerings.get(r)[n]=!e.stickerings.get(r)[n];return t}all(){return this.and(this.moves([]))}move(e){let t=this.kpuzzle.moveToTransformation(e),r=new U(this.kpuzzle,!1);for(let[i,n]of Object.entries(this.kpuzzle.definition.orbits))for(let a=0;a<n.numPieces;a++)(t.transformationData[i].permutation[a]!==a||t.transformationData[i].orientation[a]!==0)&&(r.stickerings.get(i)[a]=!0);return r}moves(e){return e.map(t=>this.move(t))}orbits(e){let t=new U(this.kpuzzle,!1);for(let r of e)t.stickerings.get(r).fill(!0);return t}orbitPrefix(e){let t=new U(this.kpuzzle,!1);for(let r in this.kpuzzle.definition.orbits)r.startsWith(e)&&t.stickerings.get(r).fill(!0);return t}},bt="Last Layer",zt="Last Slot",T={"3x3x3":bt,megaminx:bt},Z={"3x3x3":zt,megaminx:zt},bn={full:{groups:{"3x3x3":"Stickering",megaminx:"Stickering"}},OLL:{groups:T},PLL:{groups:T},LL:{groups:T},EOLL:{groups:T},COLL:{groups:T},OCLL:{groups:T},CPLL:{groups:T},CLL:{groups:T},EPLL:{groups:T},ELL:{groups:T},ZBLL:{groups:T},LS:{groups:Z},ELS:{groups:Z},CLS:{groups:Z},ZBLS:{groups:Z},VLS:{groups:Z},WVLS:{groups:Z},F2L:{groups:{"3x3x3":"CFOP (Fridrich)"}},Daisy:{groups:{"3x3x3":"CFOP (Fridrich)"}},Cross:{groups:{"3x3x3":"CFOP (Fridrich)"}},EO:{groups:{"3x3x3":"ZZ"}},EOline:{groups:{"3x3x3":"ZZ"}},EOcross:{groups:{"3x3x3":"ZZ"}},CMLL:{groups:{"3x3x3":"Roux"}},L10P:{groups:{"3x3x3":"Roux"}},L6E:{groups:{"3x3x3":"Roux"}},L6EO:{groups:{"3x3x3":"Roux"}},"2x2x2":{groups:{"3x3x3":"Petrus"}},"2x2x3":{groups:{"3x3x3":"Petrus"}},L2C:{groups:{"4x4x4":"Reduction","5x5x5":"Reduction","6x6x6":"Reduction"}},PBL:{groups:{"2x2x2":"Ortega"}},"Void Cube":{groups:{"3x3x3":"Miscellaneous"}},invisible:{groups:{"3x3x3":"Miscellaneous"}},picture:{groups:{"3x3x3":"Miscellaneous"}},"centers-only":{groups:{"3x3x3":"Miscellaneous"}},"experimental-centers-U":{},"experimental-centers-U-D":{},"experimental-centers-U-L-D":{},"experimental-centers-U-L-B-D":{},"experimental-centers":{},"experimental-fto-fc":{groups:{fto:"Bencisco"}},"experimental-fto-f2t":{groups:{fto:"Bencisco"}},"experimental-fto-sc":{groups:{fto:"Bencisco"}},"experimental-fto-l2c":{groups:{fto:"Bencisco"}},"experimental-fto-lbt":{groups:{fto:"Bencisco"}},"experimental-fto-l3t":{groups:{fto:"Bencisco"}}};async function Q(e,t){let r=await e.kpuzzle(),i=new Qe(r),n=new et(r),a=()=>n.move("U"),o=()=>n.or(n.moves(["U","D"])),s=()=>n.or(n.moves(["L","R"])),m=()=>n.not(s()),f=()=>n.not(a()),d=()=>n.orbitPrefix("CENTER"),g=()=>n.orbitPrefix("EDGE"),h=()=>n.or([n.orbitPrefix("CORNER"),n.orbitPrefix("C4RNER"),n.orbitPrefix("C5RNER")]),z=()=>n.or([m(),n.and([a(),g()])]),p=()=>n.and([a(),d()]),L=()=>n.and([n.and(n.moves(["F","R"])),g()]),Xe=()=>n.and([n.and(n.moves(["F","R"])),h(),n.not(a())]),Me=()=>n.or([Xe(),L()]);function S(){i.set(f(),"Dim")}function un(){i.set(a(),"PermuteNonPrimary"),i.set(p(),"Dim")}function pe(){i.set(a(),"IgnoreNonPrimary"),i.set(p(),"Regular")}function mn(){i.set(a(),"Ignoriented"),i.set(p(),"Dim")}switch(t){case"full":break;case"PLL":{S(),un();break}case"CLS":{S(),i.set(Xe(),"Regular"),i.set(a(),"Ignoriented"),i.set(n.and([a(),d()]),"Dim"),i.set(n.and([a(),h()]),"IgnoreNonPrimary");break}case"OLL":{S(),pe();break}case"EOLL":{S(),pe(),i.set(n.and([a(),h()]),"Ignored");break}case"COLL":{S(),i.set(n.and([a(),g()]),"Ignoriented"),i.set(n.and([a(),d()]),"Dim"),i.set(n.and([a(),h()]),"Regular");break}case"OCLL":{S(),mn(),i.set(n.and([a(),h()]),"IgnoreNonPrimary");break}case"CPLL":{S(),i.set(n.and([h(),a()]),"PermuteNonPrimary"),i.set(n.and([n.not(h()),a()]),"Dim");break}case"CLL":{S(),i.set(n.not(n.and([h(),a()])),"Dim");break}case"EPLL":{S(),i.set(a(),"Dim"),i.set(n.and([a(),g()]),"PermuteNonPrimary");break}case"ELL":{S(),i.set(a(),"Dim"),i.set(n.and([a(),g()]),"Regular");break}case"ELS":{S(),pe(),i.set(n.and([a(),h()]),"Ignored"),i.set(L(),"Regular"),i.set(Xe(),"Ignored");break}case"LL":{S();break}case"F2L":{i.set(a(),"Ignored");break}case"ZBLL":{S(),i.set(a(),"PermuteNonPrimary"),i.set(p(),"Dim"),i.set(n.and([a(),h()]),"Regular");break}case"ZBLS":{S(),i.set(Me(),"Regular"),pe(),i.set(n.and([a(),h()]),"Ignored");break}case"VLS":{S(),i.set(Me(),"Regular"),pe();break}case"WVLS":{S(),i.set(Me(),"Regular"),i.set(n.and([a(),g()]),"Ignoriented"),i.set(n.and([a(),d()]),"Dim"),i.set(n.and([a(),h()]),"IgnoreNonPrimary");break}case"LS":{S(),i.set(Me(),"Regular"),i.set(a(),"Ignored"),i.set(p(),"Dim");break}case"EO":{i.set(h(),"Ignored"),i.set(g(),"OrientationWithoutPermutation");break}case"EOline":{i.set(h(),"Ignored"),i.set(g(),"OrientationWithoutPermutation"),i.set(n.and(n.moves(["D","M"])),"Regular");break}case"EOcross":{i.set(g(),"OrientationWithoutPermutation"),i.set(n.move("D"),"Regular"),i.set(h(),"Ignored");break}case"CMLL":{i.set(f(),"Dim"),i.set(z(),"Ignored"),i.set(n.and([a(),h()]),"Regular");break}case"L10P":{i.set(n.not(z()),"Dim"),i.set(n.and([h(),a()]),"Regular");break}case"L6E":{i.set(n.not(z()),"Dim");break}case"L6EO":{i.set(n.not(z()),"Dim"),i.set(z(),"OrientationWithoutPermutation"),i.set(n.and([d(),o()]),"OrientationStickers");break}case"Daisy":{i.set(n.all(),"Ignored"),i.set(d(),"Dim"),i.set(n.and([n.move("D"),d()]),"Regular"),i.set(n.and([n.move("U"),g()]),"IgnoreNonPrimary");break}case"Cross":{i.set(n.all(),"Ignored"),i.set(d(),"Dim"),i.set(n.and([n.move("D"),d()]),"Regular"),i.set(n.and([n.move("D"),g()]),"Regular");break}case"2x2x2":{i.set(n.or(n.moves(["U","F","R"])),"Ignored"),i.set(n.and([n.or(n.moves(["U","F","R"])),d()]),"Dim");break}case"2x2x3":{i.set(n.all(),"Dim"),i.set(n.or(n.moves(["U","F","R"])),"Ignored"),i.set(n.and([n.or(n.moves(["U","F","R"])),d()]),"Dim"),i.set(n.and([n.move("F"),n.not(n.or(n.moves(["U","R"])))]),"Regular");break}case"L2C":{i.set(n.or(n.moves(["L","R","B","D"])),"Dim"),i.set(n.not(d()),"Ignored");break}case"PBL":{i.set(n.all(),"Ignored"),i.set(n.or(n.moves(["U","D"])),"PermuteNonPrimary");break}case"Void Cube":{i.set(d(),"Invisible");break}case"picture":case"invisible":{i.set(n.all(),"Invisible");break}case"centers-only":{i.set(n.not(d()),"Ignored");break}default:console.warn(`Unsupported stickering for ${e.id}: ${t}. Setting all pieces to dim.`),i.set(n.and(n.moves([])),"Dim")}return i.toStickeringMask()}async function be(e,t){let r=[],i=[];for(let[n,a]of Object.entries(bn))a.groups&&(e in a.groups?r.push(n):t?.use3x3x3Fallbacks&&"3x3x3"in a.groups&&i.push(n));return r.concat(i)}function x(e){let t=null;return()=>t??(t=e())}var ge=class extends Promise{constructor(e){super(t=>{t()}),this._executor=e}static from(e){return new ge(t=>{t(e())})}static resolve(e){return new ge(t=>{t(e)})}static reject(e){return new ge((t,r)=>{r(e)})}then(e,t){return this._promise=this._promise||new Promise(this._executor),this._promise.then(e,t)}catch(e){return this._promise=this._promise||new Promise(this._executor),this._promise.catch(e)}};function ze(e){return new ge(t=>{t(e())})}async function De(e){return(await import("./puzzle-geometry-2RB7OGB5.js")).getPuzzleGeometryByName(e,{allMoves:!0,orientCenters:!0,addRotations:!0})}async function zn(e,t){let r=await e,i=r.getKPuzzleDefinition(!0);i.name=t;let n=await import("./puzzle-geometry-2RB7OGB5.js"),a=new n.ExperimentalPGNotation(r,r.getOrbitsDef(!0));return new E(i,{experimentalPGNotation:a})}var Se,we,ye,kt,C=(kt=class{constructor(e){u(this,Se,void 0);u(this,we,void 0);u(this,ye,void 0);this.puzzleSpecificSimplifyOptionsPromise=Et(this.kpuzzle.bind(this)),this.pgId=e.pgID,this.id=e.id,this.fullName=e.fullName,this.inventedBy=e.inventedBy,this.inventionYear=e.inventionYear}pg(){return c(this,Se)??l(this,Se,De(this.pgId??this.id))}kpuzzle(){return c(this,we)??l(this,we,zn(this.pg(),this.id))}svg(){return c(this,ye)??l(this,ye,(async()=>(await this.pg()).generatesvg())())}},Se=new WeakMap,we=new WeakMap,ye=new WeakMap,kt),ee=class extends C{constructor(){super(...arguments),this.stickerings=()=>be(this.id,{use3x3x3Fallbacks:!0})}stickeringMask(e){return Q(this,e)}};function Et(e){return new ge(async t=>{let r=await e();t({quantumMoveOrder:i=>r.moveToTransformation(new R(i)).repetitionOrder()})})}var tt={name:"3x3x3",orbits:{EDGES:{numPieces:12,numOrientations:2},CORNERS:{numPieces:8,numOrientations:3},CENTERS:{numPieces:6,numOrientations:4}},startStateData:{EDGES:{pieces:[0,1,2,3,4,5,6,7,8,9,10,11],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{pieces:[0,1,2,3,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{pieces:[0,1,2,3,4,5],orientation:[0,0,0,0,0,0]}},moves:{U:{EDGES:{permutation:[1,2,3,0,4,5,6,7,8,9,10,11],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[1,2,3,0,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[1,0,0,0,0,0]}},y:{EDGES:{permutation:[1,2,3,0,5,6,7,4,10,8,11,9],orientation:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[1,2,3,0,7,4,5,6],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,2,3,4,1,5],orientation:[1,0,0,0,0,3]}},x:{EDGES:{permutation:[4,8,0,9,6,10,2,11,5,7,1,3],orientation:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[4,0,3,5,7,6,2,1],orientation:[2,1,2,1,1,2,1,2]},CENTERS:{permutation:[2,1,5,3,0,4],orientation:[0,3,0,1,2,2]}},L:{EDGES:{permutation:[0,1,2,11,4,5,6,9,8,3,10,7],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[0,1,6,2,4,3,5,7],orientation:[0,0,2,1,0,2,1,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[0,1,0,0,0,0]}},F:{EDGES:{permutation:[9,1,2,3,8,5,6,7,0,4,10,11],orientation:[1,0,0,0,1,0,0,0,1,1,0,0]},CORNERS:{permutation:[3,1,2,5,0,4,6,7],orientation:[1,0,0,2,2,1,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[0,0,1,0,0,0]}},R:{EDGES:{permutation:[0,8,2,3,4,10,6,7,5,9,1,11],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[4,0,2,3,7,5,6,1],orientation:[2,1,0,0,1,0,0,2]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[0,0,0,1,0,0]}},B:{EDGES:{permutation:[0,1,10,3,4,5,11,7,8,9,6,2],orientation:[0,0,1,0,0,0,1,0,0,0,1,1]},CORNERS:{permutation:[0,7,1,3,4,5,2,6],orientation:[0,2,1,0,0,0,2,1]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[0,0,0,0,1,0]}},D:{EDGES:{permutation:[0,1,2,3,7,4,5,6,8,9,10,11],orientation:[0,0,0,0,0,0,0,0,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,5,6,7,4],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,1,2,3,4,5],orientation:[0,0,0,0,0,1]}},z:{EDGES:{permutation:[9,3,11,7,8,1,10,5,0,4,2,6],orientation:[1,1,1,1,1,1,1,1,1,1,1,1]},CORNERS:{permutation:[3,2,6,5,0,4,7,1],orientation:[1,2,1,2,2,1,2,1]},CENTERS:{permutation:[1,5,2,0,4,3],orientation:[1,1,1,1,3,1]}},M:{EDGES:{permutation:[2,1,6,3,0,5,4,7,8,9,10,11],orientation:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[4,1,0,3,5,2],orientation:[2,0,0,0,2,0]}},E:{EDGES:{permutation:[0,1,2,3,4,5,6,7,9,11,8,10],orientation:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,4,1,2,3,5],orientation:[0,0,0,0,0,0]}},S:{EDGES:{permutation:[0,3,2,7,4,1,6,5,8,9,10,11],orientation:[0,1,0,1,0,1,0,1,0,0,0,0]},CORNERS:{permutation:[0,1,2,3,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[1,5,2,0,4,3],orientation:[1,1,0,1,0,1]}},u:{EDGES:{permutation:[1,2,3,0,4,5,6,7,10,8,11,9],orientation:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[1,2,3,0,4,5,6,7],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,2,3,4,1,5],orientation:[1,0,0,0,0,0]}},l:{EDGES:{permutation:[2,1,6,11,0,5,4,9,8,3,10,7],orientation:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[0,1,6,2,4,3,5,7],orientation:[0,0,2,1,0,2,1,0]},CENTERS:{permutation:[4,1,0,3,5,2],orientation:[2,1,0,0,2,0]}},f:{EDGES:{permutation:[9,3,2,7,8,1,6,5,0,4,10,11],orientation:[1,1,0,1,1,1,0,1,1,1,0,0]},CORNERS:{permutation:[3,1,2,5,0,4,6,7],orientation:[1,0,0,2,2,1,0,0]},CENTERS:{permutation:[1,5,2,0,4,3],orientation:[1,1,1,1,0,1]}},r:{EDGES:{permutation:[4,8,0,3,6,10,2,7,5,9,1,11],orientation:[1,0,1,0,1,0,1,0,0,0,0,0]},CORNERS:{permutation:[4,0,2,3,7,5,6,1],orientation:[2,1,0,0,1,0,0,2]},CENTERS:{permutation:[2,1,5,3,0,4],orientation:[0,0,0,1,2,2]}},b:{EDGES:{permutation:[0,5,10,1,4,7,11,3,8,9,6,2],orientation:[0,1,1,1,0,1,1,1,0,0,1,1]},CORNERS:{permutation:[0,7,1,3,4,5,2,6],orientation:[0,2,1,0,0,0,2,1]},CENTERS:{permutation:[3,0,2,5,4,1],orientation:[3,3,0,3,1,3]}},d:{EDGES:{permutation:[0,1,2,3,7,4,5,6,9,11,8,10],orientation:[0,0,0,0,0,0,0,0,1,1,1,1]},CORNERS:{permutation:[0,1,2,3,5,6,7,4],orientation:[0,0,0,0,0,0,0,0]},CENTERS:{permutation:[0,4,1,2,3,5],orientation:[0,0,0,0,0,1]}}}};tt.experimentalDerivedMoves={Uw:"u",Lw:"l",Fw:"f",Rw:"r",Bw:"b",Dw:"d",Uv:"y",Lv:"x'",Fv:"z",Rv:"x",Bv:"z'",Dv:"y'","2U":"u U'","2L":"l L'","2F":"f F'","2R":"r R'","2B":"b B'","2D":"d D'"};async function Ri(e){let t=await(e.puzzleSpecificSimplifyOptions??e.puzzleSpecificSimplifyOptionsPromise);return t?{puzzleLoader:{puzzleSpecificSimplifyOptions:t}}:{}}var Pi=new Array(24);async function Ze(e){return(await import("./puzzle-geometry-2RB7OGB5.js")).getPuzzleGeometryByDesc(e,{allMoves:!0,orientCenters:!0,addRotations:!0})}async function Dn(e){let t=await Ze(e),r=t.getKPuzzleDefinition(!0);r.name=`description: ${e}`;let i=await import("./puzzle-geometry-2RB7OGB5.js"),n=new i.ExperimentalPGNotation(t,t.getOrbitsDef(!0));return new E(r,{experimentalPGNotation:n})}var kn=1;function Li(e,t){let r=kn++,i=null,n=async()=>i??(i=Dn(e)),a={id:`custom-${r}`,fullName:t?.fullName??`Custom Puzzle (instance #${r})`,kpuzzle:n,svg:async()=>(await Ze(e)).generatesvg(),pg:async()=>Ze(e),puzzleSpecificSimplifyOptionsPromise:Et(n)};return t?.inventedBy&&(a.inventedBy=t.inventedBy),t?.inventionYear&&(a.inventionYear=t.inventionYear),a}var nt=new E(tt);tt.experimentalIsStateSolved=Pn;function Tt(e){let t=e.stateData.CENTERS.pieces[0],r=e.stateData.CENTERS.pieces[5],i=e.stateData.CENTERS.pieces[1],n=i;return t<i&&n--,r<i&&n--,[t,n]}var Dt=new Array(6).fill(0).map(()=>new Array(6)),En=!1;function Tn(){if(!En){let e=["","z","x","z'","x'","x2"].map(r=>X.fromString(r)),t=new X("y");for(let r of e){let i=nt.algToTransformation(r);for(let n=0;n<4;n++){i=i.applyAlg(t);let[a,o]=Tt(i.toKState());Dt[a][o]=i.invert()}}}return Dt}function Rn(e){let[t,r]=Tt(e),i=Tn()[t][r];return e.applyTransformation(i)}function Pn(e,t){return t.ignorePuzzleOrientation&&(e=Rn(e)),t.ignoreCenterOrientation&&(e=new G(e.kpuzzle,{EDGES:e.stateData.EDGES,CORNERS:e.stateData.CORNERS,CENTERS:{pieces:e.stateData.CENTERS.pieces,orientation:new Array(6).fill(0)}})),!!e.experimentalToTransformation()?.isIdentityTransformation()}var Ln={333:{puzzleID:"3x3x3",eventName:"3x3x3 Cube"},222:{puzzleID:"2x2x2",eventName:"2x2x2 Cube"},444:{puzzleID:"4x4x4",eventName:"4x4x4 Cube"},555:{puzzleID:"5x5x5",eventName:"5x5x5 Cube"},666:{puzzleID:"6x6x6",eventName:"6x6x6 Cube"},777:{puzzleID:"7x7x7",eventName:"7x7x7 Cube"},"333bf":{puzzleID:"3x3x3",eventName:"3x3x3 Blindfolded"},"333fm":{puzzleID:"3x3x3",eventName:"3x3x3 Fewest Moves"},"333oh":{puzzleID:"3x3x3",eventName:"3x3x3 One-Handed"},clock:{puzzleID:"clock",eventName:"Clock"},minx:{puzzleID:"megaminx",eventName:"Megaminx"},pyram:{puzzleID:"pyraminx",eventName:"Pyraminx"},skewb:{puzzleID:"skewb",eventName:"Skewb"},sq1:{puzzleID:"square1",eventName:"Square-1"},"444bf":{puzzleID:"4x4x4",eventName:"4x4x4 Blindfolded"},"555bf":{puzzleID:"5x5x5",eventName:"5x5x5 Blindfolded"},"333mb":{puzzleID:"3x3x3",eventName:"3x3x3 Multi-Blind"}};var Vi={...Ln,fto:{puzzleID:"fto",eventName:"Face-Turning Octahedron"},master_tetraminx:{puzzleID:"master_tetraminx",eventName:"Master Tetraminx"},kilominx:{puzzleID:"kilominx",eventName:"Kilominx"},redi_cube:{puzzleID:"redi_cube",eventName:"Redi Cube"}};var Lt={id:"2x2x2",fullName:"2\xD72\xD72 Cube",kpuzzle:x(async()=>new E((await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).cube2x2x2JSON)),svg:async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).cube2x2x2SVG,llSVG:x(async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).cube2x2x2LLSVG),pg:x(async()=>De("2x2x2")),stickeringMask:e=>Q(Lt,e),stickerings:()=>be("2x2x2",{use3x3x3Fallbacks:!0})};function v(e,t,r,i){let n=[];for(let a of e){let o=R.fromString(a),{family:s,amount:m}=o;if(![-1,1].includes(m))throw new Error("Invalid config move");n.push({family:s,direction:m,type:t,from:r,to:i})}return n}var _={["x axis"]:{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...v(["R"],0,0,3),...v(["L'"],1,0,3),...v(["r","Rw"],2,0,2),...v(["l'","Lw'"],3,0,2),...v(["M'"],4,1,2),...v(["x","Uv","Dv'"],5,0,3)]},["y axis"]:{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...v(["U"],0,0,3),...v(["D'"],1,0,3),...v(["u","Uw"],2,0,2),...v(["d'","Dw'"],3,0,2),...v(["E'"],4,1,2),...v(["y","Uv","Dv'"],5,0,3)]},["z axis"]:{sliceDiameter:3,extendsThroughEntirePuzzle:!0,moveSourceInfos:[...v(["F"],0,0,3),...v(["B'"],1,0,3),...v(["f","Fw"],2,0,3),...v(["b'","Bw'"],3,0,3),...v(["S"],4,1,2),...v(["z","Fv","Bv'"],5,0,3)]}},ke={};for(let[e,t]of Object.entries(_))for(let r of t.moveSourceInfos)ke[r.family]={axis:e,moveSourceInfo:r};var It={},Rt;for(let e of Object.keys(_)){let t={};It[e]=t;for(let r of _[e].moveSourceInfos)(t[Rt=r.type]??(t[Rt]=[])).push(r)}var Ct={};for(let e of Object.keys(_)){let t=new Map;Ct[e]=t;for(let r of _[e].moveSourceInfos)t.get(r.from)||t.set(r.from,r)}function Pt(e,t){let r=It[e][t]?.[0];if(!r)throw new Error(`Could not find a reference move (axis: ${e}, move source type: ${t})`);return r}var In=(e,t)=>ke[e.family].axis===ke[t.family].axis;function Cn(e,t,r,i){if(t+1===r){let h=Ct[e].get(t);if(h)return new R(new Fe(h.family),i*h.direction)}let n=_[e],{sliceDiameter:a}=n;if(t===0&&r===a){let h=Pt(e,5);return new R(new Fe(h.family),i*h.direction)}let o=t+r>a;o&&([t,r]=[a-r,a-t]);let s=t+1,m=r,f=s===m;f&&(m=null),s===1&&(s=null),f&&s===1&&(m=null),!f&&m===2&&(m=null);let g=Pt(e,f?o?1:0:o?3:2);return new R(new Fe(g.family,m,s),i*g.direction)}function On(e,t=!0){if(e.length===0)return[];let r=ke[e[0].family].axis,i=_[r],{sliceDiameter:n}=i,a=new Map,o=null;function s(h,z){let p=(a.get(h)??0)+z;t&&(p=p%4+5%4-1),p===0?a.delete(h):a.set(h,p)}let m=0;for(let h of Array.from(e).reverse()){m++;let{moveSourceInfo:z}=ke[h.family],p=h.amount*z.direction;switch(z.type){case 0:{let L=(h.innerLayer??1)-1;s(L,p),s(L+1,-p);break}case 1:{let L=n-(h.innerLayer??1);s(L,p),s(L+1,-p);break}case 2:{s((h.outerLayer??1)-1,p),s(h.innerLayer??2,-p);break}case 3:{s(n-(h.innerLayer??2),p),s(n-((h.outerLayer??1)-1),-p);break}case 4:{s(z.from,p),s(z.to,-p);break}case 5:{s(0,p),s(n,-p);break}}[0,2].includes(a.size)&&(o={suffixLength:m,sliceDeltas:new Map(a)})}if(a.size===0)return[];if(!o)return e;let[f,d]=o.sliceDeltas.keys();f>d&&([f,d]=[d,f]);let g=o.sliceDeltas.get(f);return[...e.slice(0,-o.suffixLength),...g!==0?[Cn(r,f,d,g)]:[]]}var Nn={quantumMoveOrder:()=>4,axis:{areQuantumMovesSameAxis:In,simplifySameAxisMoves:On}},Ot={id:"3x3x3",fullName:"3\xD73\xD73 Cube",inventedBy:["Ern\u0151 Rubik"],inventionYear:1974,kpuzzle:x(async()=>nt),svg:x(async()=>(await import("./puzzles-dynamic-3x3x3-QN5DUJUA-GAWIEQCD.js")).cube3x3x3SVG),llSVG:x(async()=>(await import("./puzzles-dynamic-3x3x3-QN5DUJUA-GAWIEQCD.js")).cube3x3x3LLSVG),pg:x(async()=>De("3x3x3")),stickeringMask:e=>Q(Ot,e),stickerings:()=>be("3x3x3"),puzzleSpecificSimplifyOptions:Nn},Mn={id:"clock",fullName:"Clock",inventedBy:["Christopher C. Wiggs","Christopher J. Taylor"],inventionYear:1988,kpuzzle:x(async()=>new E((await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).clockJSON)),svg:x(async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).clockSVG)};async function Fn(e,t){let r=await e.kpuzzle(),i=new Qe(r),n=new et(r),a=()=>n.and([n.move("U"),n.not(n.or(n.moves(["F","BL","BR"])))]),o=()=>n.and([n.move("U"),n.not(n.move("F"))]),s=()=>n.or([o(),n.and([n.move("F"),n.not(n.or(n.moves(["U","BL","BR"])))])]),m=()=>n.not(n.or([n.and([n.move("U"),n.move("F")]),n.and([n.move("F"),n.move("BL")]),n.and([n.move("F"),n.move("BR")]),n.and([n.move("BL"),n.move("BR")])])),f=()=>n.not(n.or([n.and([n.move("F"),n.move("BL")]),n.and([n.move("F"),n.move("BR")]),n.and([n.move("BL"),n.move("BR")])]));switch(t){case"full":break;case"experimental-fto-fc":{i.set(n.not(a()),"Ignored");break}case"experimental-fto-f2t":{i.set(n.not(o()),"Ignored"),i.set(a(),"Dim");break}case"experimental-fto-sc":{i.set(n.not(s()),"Ignored"),i.set(o(),"Dim");break}case"experimental-fto-l2c":{i.set(n.not(m()),"Ignored"),i.set(s(),"Dim");break}case"experimental-fto-lbt":{i.set(n.not(f()),"Ignored"),i.set(m(),"Dim");break}case"experimental-fto-l3t":{i.set(f(),"Dim");break}default:console.warn(`Unsupported stickering for ${e.id}: ${t}. Setting all pieces to dim.`),i.set(n.and(n.moves([])),"Dim")}return i.toStickeringMask()}async function An(){return["full","experimental-fto-fc","experimental-fto-f2t","experimental-fto-sc","experimental-fto-l2c","experimental-fto-lbt","experimental-fto-l3t"]}var Gn=class extends C{constructor(){super({pgID:"FTO",id:"fto",fullName:"Face-Turning Octahedron",inventedBy:["Karl Rohrbach","David Pitcher"],inventionYear:1983}),this.stickerings=An,this.svg=x(async()=>(await import("./puzzles-dynamic-unofficial-QXSDLTK5-E62JMLVJ.js")).ftoSVG)}stickeringMask(e){return Fn(this,e)}},Bn=new Gn;async function Un(e,t){return(await Nt()).includes(t)?Q(e,t):(console.warn(`Unsupported stickering for ${e.id}: ${t}. Setting all pieces to dim.`),Q(e,"full"))}var _n=ze(()=>be("megaminx"));function Nt(){return _n}var Vn=class extends C{constructor(){super({id:"megaminx",fullName:"Megaminx",inventionYear:1981}),this.stickerings=Nt,this.llSVG=x(async()=>(await import("./puzzles-dynamic-megaminx-FUKAIAP5-QFUCXNDM.js")).megaminxLLSVG)}stickeringMask(e){return Un(this,e)}},Kn=new Vn,Yn=class extends C{constructor(){super({id:"pyraminx",fullName:"Pyraminx",inventedBy:["Uwe Meffert"]}),this.svg=x(async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).pyraminxSVG)}},Hn=new Yn,Wn={id:"square1",fullName:"Square-1",inventedBy:["Karel Hr\u0161el","Vojtech Kopsk\xFD"],inventionYear:1990,kpuzzle:x(async()=>new E((await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).sq1HyperOrbitJSON)),svg:x(async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).sq1HyperOrbitSVG)},jn={id:"kilominx",fullName:"Kilominx",kpuzzle:x(async()=>{let e=await De("megaminx + chopasaurus"),t=JSON.parse(JSON.stringify(e.getKPuzzleDefinition(!0)));delete t.orbits.CENTERS,delete t.orbits.CENTERS2,delete t.startStateData.CENTERS,delete t.startStateData.CENTERS2;for(let o of Object.values(t.moves))delete o.CENTERS,delete o.CENTERS2;t.name="kilominx",delete t.experimentalPuzzleDescription;let r=await import("./puzzle-geometry-2RB7OGB5.js"),i=new r.ExperimentalPGNotation(e,e.getOrbitsDef(!0)),n=new E(t,{experimentalPGNotation:{lookupMove:o=>o.toString()==="x2"||o.toString()==="x2'"?a.transformationData:i.lookupMove(o)}}),a=n.algToTransformation("Rv2 Fv Uv'");return t.moves.x2=a,n}),svg:x(async()=>(await import("./puzzles-dynamic-unofficial-QXSDLTK5-E62JMLVJ.js")).kilominxSVG)},qn={id:"redi_cube",fullName:"Redi Cube",inventedBy:["Oskar van Deventer"],inventionYear:2009,kpuzzle:x(async()=>new E((await import("./puzzles-dynamic-unofficial-QXSDLTK5-E62JMLVJ.js")).rediCubeJSON)),svg:async()=>(await import("./puzzles-dynamic-unofficial-QXSDLTK5-E62JMLVJ.js")).rediCubeSVG},Mt=new ee({id:"4x4x4",fullName:"4\xD74\xD74 Cube"});Mt.llSVG=x(async()=>(await import("./puzzles-dynamic-4x4x4-DT42HVIY-ZHDOHXI5.js")).cube4x4x4LLSVG);var Xn={id:"melindas2x2x2x2",fullName:"Melinda's 2\xD72\xD72\xD72",inventedBy:["Melinda Green"],kpuzzle:x(async()=>new E((await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).melindas2x2x2x2OrbitJSON)),svg:x(async()=>(await import("./puzzles-dynamic-side-events-FCWYXIA7-422XL77M.js")).melindas2x2x2x2OrbitSVG)},Ki={"3x3x3":Ot,"2x2x2":Lt,"4x4x4":Mt,"5x5x5":new ee({id:"5x5x5",fullName:"5\xD75\xD75 Cube"}),"6x6x6":new ee({id:"6x6x6",fullName:"6\xD76\xD76 Cube"}),"7x7x7":new ee({id:"7x7x7",fullName:"7\xD77\xD77 Cube"}),"40x40x40":new ee({id:"40x40x40",fullName:"40\xD740\xD740 Cube"}),clock:Mn,megaminx:Kn,pyraminx:Hn,skewb:new C({id:"skewb",fullName:"Skewb",inventedBy:["Tony Durham"]}),square1:Wn,fto:Bn,gigaminx:new C({id:"gigaminx",fullName:"Gigaminx",inventedBy:["Tyler Fox"],inventionYear:2006}),master_tetraminx:new C({pgID:"master tetraminx",id:"master_tetraminx",fullName:"Master Tetraminx",inventedBy:["Katsuhiko Okamoto"],inventionYear:2002}),kilominx:jn,redi_cube:qn,melindas2x2x2x2:Xn};var re={shareAllNewRenderers:"auto",showRenderStats:!1};function Xi(e){for(let[t,r]of Object.entries(e))t in re&&(re[t]=r)}var _e,Re,Vt,$t=(Vt=class{constructor(){u(this,_e,0);u(this,Re,0)}queue(e){return new Promise(async(t,r)=>{try{let i=++ft(this,_e)._,n=await e;i>c(this,Re)&&(l(this,Re,i),t(n))}catch(i){r(i)}})}},_e=new WeakMap,Re=new WeakMap,Vt),Jt=0,O,K,Ve,Qt,N,Ke,en,Y,Kt,Zt=(Kt=class{constructor(){u(this,Ve);u(this,Ke);u(this,O,void 0);u(this,K,void 0);u(this,N,void 0);u(this,Y,void 0);l(this,O,new Set),this.lastSourceGeneration=0,l(this,K,new Set),l(this,N,!1),l(this,Y,new Map)}canReuse(e,t){return e===t||this.canReuseValue(e,t)}canReuseValue(e,t){return!1}debugGetChildren(){return Array.from(c(this,O).values())}addChild(e){c(this,O).add(e)}removeChild(e){c(this,O).delete(e)}markStale(e){if(e.detail.generation!==Jt)throw new Error("A TwistyProp was marked stale too late!");if(this.lastSourceGeneration!==e.detail.generation){this.lastSourceGeneration=e.detail.generation;for(let t of c(this,O))t.markStale(e);b(this,Ve,Qt).call(this)}}addRawListener(e,t){c(this,K).add(e),t?.initial&&e()}removeRawListener(e){c(this,K).delete(e)}addFreshListener(e){let t=new $t,r=null,i=async()=>{let n=await t.queue(this.get());r!==null&&this.canReuse(r,n)||(r=n,e(n))};c(this,Y).set(e,i),this.addRawListener(i,{initial:!0})}removeFreshListener(e){this.removeRawListener(c(this,Y).get(e)),c(this,Y).delete(e)}},O=new WeakMap,K=new WeakMap,Ve=new WeakSet,Qt=function(){c(this,N)||(l(this,N,!0),setTimeout(()=>b(this,Ke,en).call(this),0))},N=new WeakMap,Ke=new WeakSet,en=function(){if(!c(this,N))throw new Error("Invalid dispatch state!");for(let e of c(this,K))e();l(this,N,!1)},Y=new WeakMap,Kt),P,Yt,$n=(Yt=class extends Zt{constructor(t){super();u(this,P,void 0);l(this,P,ze(()=>this.getDefaultValue())),t&&l(this,P,this.deriveFromPromiseOrValue(t,c(this,P)))}set(t){l(this,P,this.deriveFromPromiseOrValue(t,c(this,P)));let r={sourceProp:this,value:c(this,P),generation:++Jt};this.markStale(new CustomEvent("stale",{detail:r}))}async get(){return c(this,P)}async deriveFromPromiseOrValue(t,r){return this.derive(await t,r)}},P=new WeakMap,Yt),Jn=class extends $n{derive(e){return e}},$i=Symbol("no value"),M,Pe,ae,Ye,tn,He,nn,Ht,Ji=(Ht=class extends Zt{constructor(t,r){super();u(this,Ye);u(this,He);u(this,M,void 0);u(this,Pe,null);u(this,ae,null);this.userVisibleErrorTracker=r,l(this,M,t);for(let i of Object.values(t))i.addChild(this)}async get(){let t=this.lastSourceGeneration;if(c(this,ae)?.generation===t)return c(this,ae).output;let r={generation:t,output:b(this,He,nn).call(this,b(this,Ye,tn).call(this),t,c(this,Pe))};return l(this,ae,r),this.userVisibleErrorTracker?.reset(),r.output}},M=new WeakMap,Pe=new WeakMap,ae=new WeakMap,Ye=new WeakSet,tn=async function(){let t={};for(let[i,n]of Object.entries(c(this,M)))t[i]=n.get();let r={};for(let i in c(this,M))r[i]=await t[i];return r},He=new WeakSet,nn=async function(t,r,i=null){let n=await t,a=s=>(l(this,Pe,{inputs:n,output:Promise.resolve(s),generation:r}),s);if(!i)return a(await this.derive(n));let o=i.inputs;for(let s in c(this,M))if(!c(this,M)[s].canReuse(n[s],o[s]))return a(await this.derive(n));return i.output},Ht),se,Wt,Zi=(Wt=class{constructor(){u(this,se,[])}addListener(e,t){let r=!1,i=n=>{r||t(n)};e.addFreshListener(i),c(this,se).push(()=>{e.removeFreshListener(i),r=!0})}addMultiListener3(e,t){this.addMultiListener(e,t)}addMultiListener(e,t){let r=!1,i=e.length-1,n=async a=>{if(i>0){i--;return}if(r)return;let o=e.map(m=>m.get()),s=await Promise.all(o);t(s)};for(let a of e)a.addFreshListener(n);c(this,se).push(()=>{for(let a of e)a.removeFreshListener(n);r=!0})}disconnect(){for(let e of c(this,se))e()}},se=new WeakMap,Wt),rn=class{constructor(e){this.callback=e,this.animFrameID=null,this.animFrame=this.animFrameWrapper.bind(this)}requestIsPending(){return!!this.animFrameID}requestAnimFrame(){this.animFrameID||(this.animFrameID=requestAnimationFrame(this.animFrame))}cancelAnimFrame(){this.animFrameID&&(cancelAnimationFrame(this.animFrameID),this.animFrameID=0)}animFrameWrapper(e){this.animFrameID=0,this.callback(e)}},Qi={floating:!0,none:!0},er=class extends Jn{getDefaultValue(){return"auto"}},Zn=Math.PI*2,Ge=360/Zn,Qn=class{},ot;globalThis.HTMLElement?ot=HTMLElement:ot=Qn;var ei=class{define(){}},Be;globalThis.customElements?Be=customElements:Be=new ei;var ti=class{constructor(e){this.sourceText=e}getAsString(){return this.sourceText}},F,jt,an=(jt=class extends ot{constructor(t){super();u(this,F,void 0);l(this,F,new Map),this.shadow=this.attachShadow({mode:t?.mode??"closed"}),this.contentWrapper=document.createElement("div"),this.contentWrapper.classList.add("wrapper"),this.shadow.appendChild(this.contentWrapper)}addCSS(t){let r=c(this,F).get(t);if(r)return r;let i=document.createElement("style");return i.textContent=t.getAsString(),c(this,F).set(t,i),this.shadow.appendChild(i),i}removeCSS(t){let r=c(this,F).get(t);r&&(this.shadow.removeChild(r),c(this,F).delete(t))}addElement(t){return this.contentWrapper.appendChild(t)}prependElement(t){this.contentWrapper.prepend(t)}removeElement(t){return this.contentWrapper.removeChild(t)}},F=new WeakMap,jt);Be.define("twisty-managed-custom-element",an);var Ee=globalThis.performance,ni=class{constructor(){this.mode=0,this.dom=document.createElement("div"),this.beginTime=(Ee||Date).now(),this.prevTime=this.beginTime,this.frames=0,this.fpsPanel=this.addPanel(new rt("FPS","#0ff","#002")),this.msPanel=this.addPanel(new rt("MS","#0f0","#020")),this.memPanel=Ee?.memory?this.addPanel(new rt("MB","#f08","#201")):null,this.REVISION=16,this.dom.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",this.dom.addEventListener("click",e=>{e.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},!1),this.showPanel(0)}addPanel(e){return this.dom.appendChild(e.dom),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++)this.dom.children[t].style.display=t===e?"block":"none";this.mode=e}begin(){this.beginTime=(Ee||Date).now()}end(){this.frames++;let e=(Ee||Date).now();if(this.msPanel.update(e-this.beginTime,200),e>=this.prevTime+1e3&&(this.fpsPanel.update(this.frames*1e3/(e-this.prevTime),100),this.prevTime=e,this.frames=0,this.memPanel)){let t=Ee.memory;this.memPanel.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e}update(){this.beginTime=this.end()}},y=Math.round(globalThis?.window?.devicePixelRatio??1),it=80*y,Ft=48*y,At=3*y,Gt=2*y,te=3*y,V=15*y,ne=74*y,ie=30*y,rt=class{constructor(e,t,r){this.name=e,this.fg=t,this.bg=r,this.min=1/0,this.max=0,this.dom=document.createElement("canvas"),this.context=this.dom.getContext("2d"),this.dom.width=it,this.dom.height=Ft,this.dom.style.cssText="width:80px;height:48px",this.context.font=`bold ${9*y}px Helvetica,Arial,sans-serif`,this.context.textBaseline="top",this.context.fillStyle=r,this.context.fillRect(0,0,it,Ft),this.context.fillStyle=t,this.context.fillText(e,At,Gt),this.context.fillRect(te,V,ne,ie),this.context.fillStyle=r,this.context.globalAlpha=.9,this.context.fillRect(te,V,ne,ie)}update(e,t){this.min=Math.min(this.min,e),this.max=Math.max(this.max,e),this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,it,V),this.context.fillStyle=this.fg,this.context.fillText(`${Math.round(e)} ${this.name} (${Math.round(this.min)}-${Math.round(this.max)})`,At,Gt),this.context.drawImage(this.dom,te+y,V,ne-y,ie,te,V,ne-y,ie),this.context.fillRect(te+ne-y,V,y,ie),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(te+ne-y,V,y,Math.round((1-e/t)*ie))}},Bt=null;async function ii(){return Bt??(Bt=import("./twisty-dynamic-3d-IAEGMDVR-434SFZLE.js"))}var Ue=ze(async()=>(await ii()).T3I),ri=null;function ct(){return ri??(devicePixelRatio||1)}var ai=new ti(`
:host {
  width: 384px;
  height: 256px;
  display: grid;
}

.wrapper {
  width: 100%;
  height: 100%;
  display: grid;
  overflow: hidden;
  place-content: center;
  contain: strict;
}

.loading {
  width: 4em;
  height: 4em;
  border-radius: 2.5em;
  border: 0.5em solid rgba(0, 0, 0, 0);
  border-top: 0.5em solid rgba(0, 0, 0, 0.7);
  border-right: 0.5em solid rgba(0, 0, 0, 0.7);
  animation: fade-in-delayed 4s, rotate 1s linear infinite;
}

@keyframes fade-in-delayed {
  0% { opacity: 0; }
  25% {opacity: 0; }
  100% { opacity: 1; }
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* TODO: This is due to stats hack. Replace with \`canvas\`. */
.wrapper > canvas {
  max-width: 100%;
  max-height: 100%;
  animation: fade-in 0.25s ease-in;
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.wrapper.invisible {
  opacity: 0;
}

.wrapper.drag-input-enabled > canvas {
  cursor: grab;
}

.wrapper.drag-input-enabled > canvas:active {
  cursor: grabbing;
}
`),Ut=.1,H,W,oe,We,sn,je,on,Le,lt,qt,si=(qt=class extends EventTarget{constructor(t){super();u(this,We);u(this,je);u(this,Le);u(this,H,new Map);u(this,W,new Map);u(this,oe,!1);this.target=t}start(){this.addTargetListener("pointerdown",this.onPointerDown.bind(this)),this.addTargetListener("contextmenu",t=>{t.preventDefault()}),this.addTargetListener("touchmove",t=>t.preventDefault()),this.addTargetListener("dblclick",t=>t.preventDefault())}stop(){for(let[t,r]of c(this,W).entries())this.target.removeEventListener(t,r);c(this,W).clear(),l(this,oe,!1)}addTargetListener(t,r){c(this,W).has(t)||(this.target.addEventListener(t,r),c(this,W).set(t,r))}onPointerDown(t){b(this,We,sn).call(this);let r={attachedInfo:{},hasMoved:!1,lastClientX:t.clientX,lastClientY:t.clientY,lastTimeStamp:t.timeStamp};c(this,H).set(t.pointerId,r),this.target.setPointerCapture(t.pointerId)}onPointerMove(t){let r=b(this,Le,lt).call(this,t).movementInfo;r&&(t.preventDefault(),this.dispatchEvent(new CustomEvent("move",{detail:r})))}onPointerUp(t){let r=b(this,Le,lt).call(this,t),i=c(this,H).get(t.pointerId);b(this,je,on).call(this,t),this.target.releasePointerCapture(t.pointerId);let n;if(r.hasMoved)n=new CustomEvent("up",{detail:{attachedInfo:i.attachedInfo}});else{let{altKey:a,ctrlKey:o,metaKey:s,shiftKey:m}=t;n=new CustomEvent("press",{detail:{normalizedX:t.offsetX/this.target.offsetWidth*2-1,normalizedY:1-t.offsetY/this.target.offsetHeight*2,rightClick:!!(t.button&2),keys:{altKey:a,ctrlOrMetaKey:o||s,shiftKey:m}}})}this.dispatchEvent(n)}},H=new WeakMap,W=new WeakMap,oe=new WeakMap,We=new WeakSet,sn=function(){c(this,oe)||(this.addTargetListener("pointermove",this.onPointerMove.bind(this)),this.addTargetListener("pointerup",this.onPointerUp.bind(this)),l(this,oe,!0))},je=new WeakSet,on=function(t){c(this,H).delete(t.pointerId)},Le=new WeakSet,lt=function(t){let r=c(this,H).get(t.pointerId);if(!r)return{movementInfo:null,hasMoved:!1};let i;return(t.movementX??0)!==0||(t.movementY??0)!==0?i={attachedInfo:r.attachedInfo,movementX:t.movementX,movementY:t.movementY,elapsedMs:t.timeStamp-r.lastTimeStamp}:i={attachedInfo:r.attachedInfo,movementX:t.clientX-r.lastClientX,movementY:t.clientY-r.lastClientY,elapsedMs:t.timeStamp-r.lastTimeStamp},r.lastClientX=t.clientX,r.lastClientY=t.clientY,r.lastTimeStamp=t.timeStamp,Math.abs(i.movementX)<Ut&&Math.abs(i.movementY)<Ut?{movementInfo:null,hasMoved:r.hasMoved}:(r.hasMoved=!0,{movementInfo:i,hasMoved:r.hasMoved})},qt),Te=[];async function oi(e,t,r,i){Te.length===0&&Te.push(dt());let n=await Te[0];return n.setSize(e,t),n.render(r,i),n.domElement}async function ci(e,t,r,i,n){if(e===0||t===0)return;Te.length===0&&Te.push(dt());let a=await oi(e,t,i,n),o=r.getContext("2d");o.clearRect(0,0,r.width,r.height),o.drawImage(a,0,0)}async function dt(){let e=(await Ue).WebGLRenderer,t=new e({antialias:!0,alpha:!0});return t.setPixelRatio(ct()),t}var li=!0,at=500,ui=50,mi=.75;function _t(e){return(Math.exp(1-e)-(1-e))/(1-Math.E)+1}var di=class{constructor(e,t,r,i){this.startTimestamp=e,this.momentumX=t,this.momentumY=r,this.callback=i,this.scheduler=new rn(this.render.bind(this)),this.scheduler.requestAnimFrame(),this.lastTimestamp=e}render(e){let t=(this.lastTimestamp-this.startTimestamp)/at,r=Math.min(1,(e-this.startTimestamp)/at);if(t===0&&r>ui/at)return;let i=_t(r)-_t(t);this.callback(this.momentumX*i*1e3,this.momentumY*i*1e3),r<1&&this.scheduler.requestAnimFrame(),this.lastTimestamp=e}},fi=class{constructor(e,t,r,i){this.model=e,this.mirror=t,this.canvas=r,this.dragTracker=i,this.experimentalInertia=li,this.onMovementBound=this.onMovement.bind(this),this.experimentalHasBeenMoved=!1,this.dragTracker.addEventListener("move",this.onMove.bind(this)),this.dragTracker.addEventListener("up",this.onUp.bind(this))}temperMovement(e){return Math.sign(e)*Math.log(Math.abs(e*10)+1)/6}onMove(e){var t;(t=e.detail).attachedInfo??(t.attachedInfo={});let{temperedX:r,temperedY:i}=this.onMovement(e.detail.movementX,e.detail.movementY),n=e.detail.attachedInfo;n.lastTemperedX=r*10,n.lastTemperedY=i*10,n.timestamp=e.timeStamp}onMovement(e,t){let r=this.mirror?-1:1,i=Math.min(this.canvas.offsetWidth,this.canvas.offsetHeight),n=this.temperMovement(e/i),a=this.temperMovement(t/i*mi);return this.model.twistySceneModel.orbitCoordinatesRequest.set((async()=>{let o=await this.model.twistySceneModel.orbitCoordinates.get();return{latitude:o.latitude+2*a*Ge*r,longitude:o.longitude-2*n*Ge}})()),{temperedX:n,temperedY:a}}onUp(e){e.preventDefault(),"lastTemperedX"in e.detail.attachedInfo&&"lastTemperedY"in e.detail.attachedInfo&&"timestamp"in e.detail.attachedInfo&&e.timeStamp-e.detail.attachedInfo.timestamp<60&&new di(e.timeStamp,e.detail.attachedInfo.lastTemperedX,e.detail.attachedInfo.lastTemperedY,this.onMovementBound)}};async function hi(e,t,r=!1){let i=new(await Ue).Spherical(t.distance,(90-(r?-1:1)*t.latitude)/Ge,((r?180:0)+t.longitude)/Ge);i.makeSafe(),e.position.setFromSpherical(i),e.lookAt(0,0,0)}var st=0,pi=2,cn=!1;function xi(){return re.shareAllNewRenderers!=="auto"?(re.shareAllNewRenderers||st++,re.shareAllNewRenderers!=="never"):st<pi?(st++,!1):(cn=!0,!0)}function tr(){return cn}var qe,ln,Ie,ce,le,Ce,ut,ue,me,de,Oe,mt,fe,he,j,q,Ne,Xt,vi=(Xt=class extends an{constructor(t,r,i){super();u(this,qe);u(this,Ce);u(this,Oe);u(this,Ie,void 0);u(this,ce,void 0);u(this,le,void 0);u(this,ue,void 0);u(this,me,void 0);u(this,de,void 0);u(this,fe,void 0);u(this,he,void 0);u(this,j,void 0);u(this,q,void 0);u(this,Ne,void 0);this.model=t,this.options=i,this.scene=null,this.stats=null,this.rendererIsShared=xi(),this.loadingElement=null,l(this,Ie,new $t),l(this,ce,0),l(this,le,0),l(this,ue,null),l(this,me,null),l(this,de,null),l(this,fe,null),l(this,he,null),l(this,j,[]),l(this,q,null),l(this,Ne,new rn(this.render.bind(this))),this.scene=r??null,this.loadingElement=this.addElement(document.createElement("div")),this.loadingElement.classList.add("loading"),re.showRenderStats&&(this.stats=new ni,this.stats.dom.style.position="absolute",this.contentWrapper.appendChild(this.stats.dom))}async connectedCallback(){this.addCSS(ai),this.addElement((await this.canvasInfo()).canvas),b(this,Ce,ut).call(this),new ResizeObserver(b(this,Ce,ut).bind(this)).observe(this.contentWrapper),this.orbitControls(),b(this,qe,ln).call(this),this.scheduleRender()}async clearCanvas(){if(this.rendererIsShared){let t=await this.canvasInfo();t.context.clearRect(0,0,t.canvas.width,t.canvas.height)}else{let r=(await this.renderer()).getContext();r.clear(r.COLOR_BUFFER_BIT)}}async renderer(){if(this.rendererIsShared)throw new Error("renderer expected to be shared.");return c(this,ue)??l(this,ue,dt())}async canvasInfo(){return c(this,me)??l(this,me,(async()=>{let t;if(this.rendererIsShared)t=this.addElement(document.createElement("canvas"));else{let i=await this.renderer();t=this.addElement(i.domElement)}this.loadingElement?.remove();let r=t.getContext("2d");return{canvas:t,context:r}})())}async camera(){return c(this,fe)??l(this,fe,(async()=>{let t=new(await Ue).PerspectiveCamera(20,1,.1,20);return t.position.copy(new(await Ue).Vector3(2,4,4).multiplyScalar(this.options?.backView?-1:1)),t.lookAt(0,0,0),t})())}async orbitControls(){return c(this,he)??l(this,he,(async()=>{let t=new fi(this.model,!!this.options?.backView,(await this.canvasInfo()).canvas,await b(this,Oe,mt).call(this));return this.model&&this.addListener(this.model.twistySceneModel.orbitCoordinates,async r=>{let i=await this.camera();hi(i,r,this.options?.backView),this.scheduleRender()}),t})())}addListener(t,r){t.addFreshListener(r),c(this,j).push(()=>{t.removeFreshListener(r)})}disconnect(){for(let t of c(this,j))t();l(this,j,[])}experimentalNextRenderFinishedCallback(t){l(this,q,t)}async render(){var n;if(!this.scene)throw new Error("Attempted to render without a scene");this.stats?.begin();let[t,r,i]=await Promise.all([this.scene.scene(),this.camera(),this.canvasInfo()]);this.rendererIsShared?ci(c(this,ce),c(this,le),i.canvas,t,r):(await this.renderer()).render(t,r),this.stats?.end(),(n=c(this,q))==null||n.call(this),l(this,q,null)}scheduleRender(){c(this,Ne).requestAnimFrame()}},qe=new WeakSet,ln=async function(){(await b(this,Oe,mt).call(this)).addEventListener("press",async r=>{await this.model.twistySceneModel.movePressInput.get()==="basic"&&this.dispatchEvent(new CustomEvent("press",{detail:{pressInfo:r.detail,cameraPromise:this.camera()}}))})},Ie=new WeakMap,ce=new WeakMap,le=new WeakMap,Ce=new WeakSet,ut=async function(){let t=await c(this,Ie).queue(this.camera()),r=this.contentWrapper.clientWidth,i=this.contentWrapper.clientHeight;l(this,ce,r),l(this,le,i);let n=0,a=0,o=0;if(i>r&&(o=i-r,a=-Math.floor(.5*o)),t.aspect=r/i,t.setViewOffset(r,i-o,n,a,r,i),t.updateProjectionMatrix(),this.clearCanvas(),this.rendererIsShared){let s=await this.canvasInfo();s.canvas.width=r*ct(),s.canvas.height=i*ct(),s.canvas.style.width=`${r.toString()}px`,s.canvas.style.height=`${i.toString()}px`}else(await this.renderer()).setSize(r,i,!0);this.scheduleRender()},ue=new WeakMap,me=new WeakMap,de=new WeakMap,Oe=new WeakSet,mt=async function(){return c(this,de)??l(this,de,(async()=>{let t=new si((await this.canvasInfo()).canvas);return this.model?.twistySceneModel.dragInput.addFreshListener(r=>{let i=!1;switch(r){case"auto":{t.start(),i=!0;break}case"none":{t.stop();break}}this.contentWrapper.classList.toggle("drag-input-enabled",i)}),t})())},fe=new WeakMap,he=new WeakMap,j=new WeakMap,q=new WeakMap,Ne=new WeakMap,Xt);Be.define("twisty-3d-vantage",vi);export{Ti as a,yn as b,Ri as c,Li as d,Ot as e,Ki as f,Xi as g,$t as h,$n as i,Jn as j,$i as k,Ji as l,Zi as m,rn as n,Qi as o,er as p,Zn as q,Ge as r,ot as s,Be as t,ti as u,an as v,ii as w,Ue as x,oi as y,hi as z,tr as A,vi as B};
//# sourceMappingURL=chunk-L5E5DRC7.js.map
